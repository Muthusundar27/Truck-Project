<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Add Truck</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="container">
    <h2>Add Truck</h2>

    <form class="truck-form" id="truckForm">
      <!-- Vehicle No -->
      <div class="form-section">
        <label for="vehicleNo">Vehicle No.</label>
        <input type="text" id="vehicleNo" placeholder="TN-09-1234" />
      </div>

      <!-- Vehicle Model -->
      <div class="form-section">
        <label for="vehicleModel">Vehicle Model</label>
        <select id="vehicleModel">
          <option value="">Select Model</option>
          <option value="Tipper">Tipper</option>
          <option value="Platform">Platform</option>
          <option value="Container">Container</option>
          <option value="Tanker">Tanker</option>
        </select>
      </div>

      <!-- Tyre Count -->
      <div class="form-section">
        <label for="tyreCount">Tyre Count</label>
        <select id="tyreCount">
          <option value="">Select Tyre Count</option>
          <option value="6">6</option>
          <option value="10">10</option>
          <option value="12">12</option>
          <option value="14">14</option>
        </select>
      </div>

      <!-- Diesel Quantity -->
      <div class="form-section">
        <label for="dieselQty">Diesel Quantity (Litres)</label>
        <select id="dieselQty">
          <option value="">Select Quantity</option>
          <option value="100">100</option>
          <option value="200">200</option>
          <option value="300">300</option>
          <option value="400">400</option>
        </select>
      </div>

      <!-- Vehicle Owner -->
      <div class="form-section">
        <label for="vehicleOwner">Vehicle Owner</label>
        <input type="text" id="vehicleOwner" placeholder="Owner Name" />
      </div>

      <!-- On Due -->
      <div class="form-section">
        <label>On Due</label>
        <div class="radio-group">
          <label><input type="radio" name="onDue" value="Yes" /> Yes</label>
          <label><input type="radio" name="onDue" value="No" /> No</label>
        </div>
      </div>

      <!-- Due Date -->
      <div class="form-section">
        <label for="dueDate">Due Date</label>
        <input type="date" id="dueDate" />
      </div>

      <!-- Loan Provider -->
      <div class="form-section">
        <label for="loanProvider">Loan Provider</label>
        <input type="text" id="loanProvider" placeholder="Bank or Finance Company" />
      </div>

      <!-- EMI Amount -->
      <div class="form-section">
        <label for="emiAmount">EMI Amount</label>
        <input type="text" id="emiAmount" placeholder="₹ EMI" />
      </div>

      <!-- Pollution Certificate Renewal Date -->
      <div class="form-section">
        <label for="pollutionDate">Pollution Certificate Renewal Date</label>
        <input type="date" id="pollutionDate" />
      </div>

      <!-- Tax Date -->
      <div class="form-section">
        <label for="taxDate">Tax Date</label>
        <input type="date" id="taxDate" />
      </div>

      <!-- Insurance Date -->
      <div class="form-section">
        <label for="insuranceDate">Insurance Date</label>
        <input type="date" id="insuranceDate" />
      </div>

      <!-- FC Date -->
      <div class="form-section">
        <label for="fcDate">FC Date</label>
        <input type="date" id="fcDate" />
      </div>

      <!-- Permit Date -->
      <div class="form-section">
        <label for="permitDate">Permit Date</label>
        <input type="date" id="permitDate" />
      </div>

      <!-- Attachments -->
      <div class="form-section">
        <label>Attach RC / Insurance</label>
        <input type="file" multiple />
      </div>

      <!-- Save Buttons -->
      <div class="actions">
        <button type="button" class="btn-green" id="saveBtn">Save</button>
        <button type="button" class="btn-gray" onclick="window.location.href='dashboardPage.html'">Cancel</button>
      </div>
    </form>
  </div>

  <script>
    // Helper: check if a date is within next N days (including past dates)
    function isDateDue(dateStr, daysAhead = 7) {
      if (!dateStr) return false;
      const now = new Date();
      const date = new Date(dateStr);
      const diffTime = date.getTime() - now.getTime();
      const diffDays = diffTime / (1000 * 60 * 60 * 24);

      return diffDays <= daysAhead && diffDays >= -1; // Due if within next 7 days or overdue by 1 day
    }

    function notifyDueDates() {
      const dateFields = [
        { id: 'dueDate', label: 'Due Date' },
        { id: 'pollutionDate', label: 'Pollution Certificate Renewal Date' },
        { id: 'taxDate', label: 'Tax Date' },
        { id: 'insuranceDate', label: 'Insurance Date' },
        { id: 'fcDate', label: 'FC Date' },
        { id: 'permitDate', label: 'Permit Date' },
      ];

      const dueNotifications = [];

      dateFields.forEach(field => {
        const dateValue = document.getElementById(field.id).value;
        if (isDateDue(dateValue)) {
          dueNotifications.push(`${field.label} is due soon or overdue! (${dateValue})`);
        }
      });

      if (dueNotifications.length > 0) {
        alert('⚠️ Reminder:\n\n' + dueNotifications.join('\n'));
      }
    }

    // Save button click handler
    document.getElementById('saveBtn').addEventListener('click', () => {
      // Run notification check
      notifyDueDates();

      // TODO: Add your save logic here (e.g., save form data, send to server, etc.)

      // Redirect to dashboard after save
      window.location.href = 'dashboardPage.html';
    });
  </script>
</body>

</html>
