<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .truck-btn.active {
      background-color: #007bff;
      color: white;
    }
  </style>
</head>

<body>
  <div class="container">
    <h2>Hello, Ravi!</h2>

    <!-- Summary Section -->
    <div class="summary-box">
      <div class="summary-card btn-green">
        <div class="label">Income</div>
        <div class="amount" id="incomeAmount">â‚¹0</div>
      </div>
      <div class="summary-card btn-red">
        <div class="label">Expense</div>
        <div class="amount" id="expenseAmount">â‚¹0</div>
      </div>
    </div>

    <!-- Truck Selection -->
    <div class="trucks">
      <button class="truck-btn" onclick="selectTruck('Truck 1')">ðŸš› Truck 1</button>
      <button class="truck-btn" onclick="selectTruck('Truck 2')">ðŸš› Truck 2</button>
      <button class="truck-btn" onclick="window.location.href='lorryDetails.html'">âž• Add Truck</button>
    </div>

    <!-- Chart Section -->
    <canvas id="incomeExpenseChart" height="100"></canvas>


    <!-- Action Buttons -->
    <div class="actions">
      <button class="btn-green" onclick="window.location.href='addIncomePage.html'">âž• Add Income</button>
      <button class="btn-red" onclick="window.location.href='addExpensePage.html'">âž• Add Expense</button>
    </div>
  </div>

  <script>
    const truckData = {
      'Truck 1': { income: 50000, expense: 30000 },
      'Truck 2': { income: 20000, expense: 15000 }
    };

    let chart; // Store Chart.js instance

    function selectTruck(truckName) {
      // Highlight selected button
      document.querySelectorAll('.truck-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.textContent.includes(truckName)) btn.classList.add('active');
      });

      const data = truckData[truckName] || { income: 0, expense: 0 };

      // Update income & expense UI
      document.getElementById('incomeAmount').textContent = `â‚¹${data.income.toLocaleString()}`;
      document.getElementById('expenseAmount').textContent = `â‚¹${data.expense.toLocaleString()}`;

      // Draw or update the chart
      updateChart(data.income, data.expense, truckName);
    }

    function updateChart(income, expense, truckName) {
      const ctx = document.getElementById('incomeExpenseChart').getContext('2d');

      if (chart) chart.destroy(); // Clear previous chart

      chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Income', 'Expense'],
          datasets: [{
            label: `${truckName} Overview`,
            data: [income, expense],
            backgroundColor: ['#28a745', '#dc3545']
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false },
            title: {
              display: true,
              text: `Income vs Expense for ${truckName}`
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: value => 'â‚¹' + value.toLocaleString()
              }
            }
          }
        }
      });
    }

    // Select first truck on load
    window.onload = () => {
      selectTruck('Truck 1');
    };
  </script>

</body>

</html>